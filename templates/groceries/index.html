{% extends 'groceries/basic.html' %}
{% block title %}{% endblock title %}

{% block body %}
{% load static %}
<div class="container-fluid mt-2">
<div class="row">
    <div class="col-3">
    <div class="list-group">
      {% for cat in category %}
        <a href="category/{{cat.id}}" class="list-group-item list-group-item-action">{{cat.name}}</a>
        {% endfor %}
   

    </div>
    </div>
    <div class="col-9">
        <div class="container-fluid mt-2">
    <div id="carouselExampleCaptions" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="{% static 'groceries/images/1.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>First slide label</h5>
        <p>Some representative placeholder content for the first slide.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'groceries/images/2.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>Second slide label</h5>
        <p>Some representative placeholder content for the second slide.</p>
      </div>
    </div>
    <div class="carousel-item">
      <img src="{% static 'groceries/images/3.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
      <div class="carousel-caption d-none d-md-block">
        <h5>Third slide label</h5>
        <p>Some representative placeholder content for the third slide.</p>
      </div>
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions"  data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions"  data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
         <div class="container">
         <div class="container">
         <div class="row">
         <div class="col-10 my-2">
        <h1 style="text-align:center"><b>Best Deals Today</b></h1>
        </div>
        <div class="col-2 my-2">
        <a href="#" class="btn btn-info btn-lg disabled" tabindex="-1" role="button" aria-disabled="true">SeeAll</a>
                </div>
        </div>
        <div class="row">
          <div id="carouselExampleInterval" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner">
              <div class="carousel-item active" data-bs-interval="10000">
                <img src="{% static 'groceries/images/5.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
              </div>
              <div class="carousel-item" data-bs-interval="2000">
                <img src="{% static 'groceries/images/9.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
              </div>
              <div class="carousel-item">
                <img src="{% static 'groceries/images/25.jpg' %}" class="d-block w-100" width="1600" height="500" alt="...">
              </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleInterval" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Next</span>
            </button>
          </div>
        </div>  
        </div>

{% endblock body %}

{% block js %}
  <script>
    if(localStorage.getItem('cart')==null){
    var cart={};
  }

  else{
    cart=JSON.parse(localStorage.getItem('cart'));
    document.getElementById('cart').innerHTML=Object.keys(cart).length;
    updatecart(cart);
  }

  $('.cart').click(function(){
    var idstr=this.id.toString();
    if(cart[idstr]!=undefined){
    cart[idstr]=cart[idstr]+1;
  }

  else{
    cart[idstr]=1;
  }
  updatecart(cart)
  // localStorage.setItem('cart',JSON.stringify(cart));
  // document.getElementById('cart').innerHTML=Object.keys(cart).length;

  })
  $('#popcart').popover();
  updatepopover(cart);
  function updatepopover(cart){
  var popstr="";
  popstr=popstr+"<h5>Cart for your items in my shopping cart</h5>";
  var i=1;
  for(var item in cart){
    popstr=popstr+"<b>" + i + "</b>"
    popstr=popstr+'-'+document.getElementById("name"+item).innerHTML+ "....Qty: " + cart[item]+ '<br>';
    i=i+1;
  }
  popstr=popstr+"</div>"
  document.getElementById("popcart").setAttribute('data-content', popstr);
  $('#popcart').popover();
  
}
function updatecart(cart){
  // var sum=0;
  for (var item in cart){
    // sum=sum+cart[item];
    document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "'>" + cart[item] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
  }
  localStorage.setItem('cart', JSON.stringify(cart));
  document.getElementById('cart').innerHTML = Object.keys(cart).length;
  updatepopover(cart);

}
//if minus or plus button is clicked
$('.divpr').on("click","button.minus",function(){
  a=this.id.slice(7,)
  cart['pr'+a]=cart['pr'+a]-1;
  cart['pr'+a]=Math.max(0,cart['pr'+a])
  document.getElementById('valpr'+a).innerHTML=cart['pr'+a];
  updatecart(cart)
});
  
$('.divpr').on("click","button.plus",function(){
  a=this.id.slice(6,)
  cart['pr'+a]=cart['pr'+a]+1;
  document.getElementById('valpr'+a).innerHTML=cart['pr'+a];
  updatecart(cart)
});
</script>
   
  </script>
  {% endblock js %}